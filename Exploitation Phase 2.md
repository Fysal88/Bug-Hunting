# Exploitation Phase [Part-2]
## 1.Exploiting CMS
- A content management system (CMS) is a software application that can be used to manage the creation and modification of digital content

### 1.1 Wordpress
- There are in fact hundreds of exploits and misconfigurations impacting WordPress and its associated plugins. One common tool to scan for these vulnerabilities is wpscan: 
	-  https://github.com/wpscanteam/wpscan
-  TIP: Always make sure to check “/wp-content/uploads/” .

### 1.2 Joomla
- If you want to scan for vulnerabilities the most popular tool is Joomscan: 
	-  https://github.com/rezasp/joomscan
	```bash
	perl joomscan.pl -u <URL Here>
	```

### 1.3 Drupal
- If you find a Drupal site you want to use droopescan to scan it
	- https://github.com/droope/droopescan	
```bash
python3 droopescan scan Drupal -u <URL Here> -t 32
```

### 1.4 Adobe AEM
- If you want to scan an application for vulnerabilities use
the tool aemhacker:
	-  https://github.com/0ang3el/aem-hacker
```bash
python aem_hacker.py -u <URL Here> --host <Your Public IP>
```
- Note that in order to test for the SSRF vulnerabilities you need to have a public IP that the target server can connect back to.

- If you come across a CMS you haven't seen before the first step is to go to xploit db and see if it has any known CVEs:
	-  https://www.exploit-db.com/

<hr>

## 2. Eploitation OWASP
- The only tool you need is Burp Suite: 
	-  https://portswigger.net/burp

### 2.1 XML External Entity (XXE)
- XML External Entity (XXE) is a vulnerability that can appear when an application parses XML
- you can use external entities to grab data from a file on disk and store it in a variable. What if we tried to read data from the “/etc/passwd” file and store it in a variable? Note that in order to read the data the entity must be returned in the response.
- Exploitation:
	- Capture the POST request in Burp. Whenever you see XML you should test for XXE :
	- To test for XXE simply put in your malicious external entity and replace each node value with it as shown below:
	![](assets/xmlp.png)
	- If the server doesn’t block external entities the response will be reflected. 
	![](assets/xml2.png)
	
### 2.2 Cross Site Scripting (XSS)
- This vulnerability can be used to execute malicious JavaScript in a user’s web browser. This could then be used to steal users JWT tokens, CSRF tokens, and cookies. 
- There are three types of XSS reflected, stored, and DOM based.
	1. <b><u>Reflected XSS:</u> </b>  Suppose you have an application which produces an error message when you type in the wrong user name and password. The error message could look something like this:
		<i>“The email or password you entered is not valid. Please try again.”</i> 
		- You then notice that there is a GET parameter in the URL which has this same message:
	  <i>“example.com/login.php?error=The+email+or+password+you+entered+is+not
valid.+Please+try+again.”</i>
 - If the application doesn’t protect against XSS we could insert malicious JavaScript code into the user browser.
	2. <b><u>Stored XSS:</u> </b>
	 ![](assets/xss.png)
	- Suppose you have an application that allows you to create an account. The application also has a page which lists out all the members of the site. You could assume that the username you create is being stored in the backend database otherwise how would the application be able to retrieve this information. If youwere to put a malicious JavaScript payload as your username it would then be stored in the back-end database. If the application isn’t blocking XSS attacks whenever someone visits the members list page your username would be retrieved from the back-end database and your XSS payload would trigger.
	
	3. <b><u>DOM XSS:</u> </b>
	- Document Object Model (DOM) based XSS occurs when an application takes user supplied input passes it to a JavaScript function and that function uses the input to modify the DOM environment.
	- ![](assets/xxs3.png)

### 2.3 SSRF
- Server-Side Request Forgery (SSRF). 