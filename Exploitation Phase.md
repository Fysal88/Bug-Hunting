# Exploitation Phase
- When searching for vulnerabilities I always start out looking for low hanging fruit.
## 1. Subdomain Takeover 
### 1.1 Intro
- Searching for subdomain takeovers is one of the easiest vulnerabilities you can find and it normally pays fairly well.
-  A subdomain takeover occurs when a domain is pointing to another domain (CNAME) that no longer exists.
-  If an attacker were to register that non existing domain then the targets subdomain would now point to your domain effectively giving you full control over the target’s subdomain.

### 1.2 Subdomain Takeover
- You should be searching for subdomain takeovers on a daily basis. Just because you checked your target yesterday doesn't mean they are safe today.
- Before you can check for subdomain takeover you need to get a list of your target’s subdomains, this should have been done during the recon phase
- Once you have a list of subdomains checking for this vulnerability should only take about 5 minutes with the following tool:
	-  https://github.com/haccer/subjack
-  ```bash
./subjack -w <Subdomain List> -o results.txt -ssl -c fingerprints.json
- The next step is to see where this domain is pointing to so we can try to take it over
	- ```bash
	dig <Domain Here>
	

### 1.3 Conclusion
- Subdomain takeover is one of the easiest high impact vulnerabilities you can search for. As long as you have a list of subdomains checking for this vulnerability is a matter of running a command. Administrators are constantly changing DNS setting so a company may be safe one day and vulnerable the next because of this it’s a good idea to constantly check for this vulnerability.
- ---

## 2. Github
- When performing your initial recon on an organization don’t forget about GitHub. GitHub is used by developers to maintain and share their code, most of the time they end up sharing much more though.

### 2.1 Github Dorks
- GitHub dorks are basically the same thing as google dorks. A dork is used to find specific information in a sea of information. It helps us narrow down the search to exactly what we want.
- This can be very handy when searching for sensitive files, API keys, passwords, and a lot more.
- We can use dorks to find sensitive files that developers might have accidentally uploaded.
	- filename:.bash_history DOMAIN-NAME
- A good list of these dorks can be found below:
	- https://github.com/techgaun/github-dorks/blob/master/github-dorks.txt

### 2.2 Company Github
- Instead of using GitHub dorks to find exposures you might want to go directly to the source. To do this you must find the companies GitHub page and from there you can locate all their developers and monitor their accounts.
- Once you find a company's page you want to get a list of people that are associated with the company. This can be done by clicking on the “people” tab.
- Now you will need to manually go through each one and look for exposures. 
- You should be looking for URLs, api keys, usernames, paswords, vulnerabilities, and anything else that could provide value.

<hr>

## 3. Misconfigured Cloud Storage Buckets
- Today companies are moving their infrastructure to the cloud as it is more convenient to ent resources from third parties. However, cloud services can be tricky to set up roperly if you don’t know what you’re doing thus people mess things up and introduce vulnerabilities into their environment. 
- One of the most popular vulnerabilities is finding an exposed cloud storage bucket. These buckets are used to store files so depending on what's in the bucket you might have access to sensitive information.

### 3.1 AWS S3 Bucket
- Amazon Web Services (AWS) is by far the most popular cloud service provider out there. The vast majority of cloud instances you come across will be hosted on this provider.

#### 3.1.1 Bucket Dorks
- google dork can be used to find buckets belonging to a company:
	- site:.s3.amazonaws.com "Starbucks"

#### 3.1.2 S3 Bucket Brute force
- There are way too many S3 bucket brute force tools:
	- https://github.com/ghostlulzhacks/s3brute
	- ```Bash
	python amazon-s3-enum.py -w BucketNames.txt -d <Domain Here>
- If you go to the vulnerable endpoint you should be able to list all files in the bucket. You should be looking for sensitive files such as backup files, zip files, user data, and any other PII information

### 3.2 Google Cloud Storage
- The following tool can be used to brute force these bucket names. Similar to by AWS tool it uses permutations to generate bucket names.
	- https://github.com/RhinoSecurityLabs/GCPBucketBrute
- Once you find a vulnerable endpoint visit it and search for sensitive files siilar to the AWS process.

### 3.3 Digital Ocean Spaces
- If you are familiar with S3 buckets Digital ocean spaces are literally the same exact technology
	- ``` 
	site:digitaloceanspaces.com <Domain Here>
	- This will give you sensitive files. 

	
## 4. Elastic Search DB
- ES is a document-oriented database designed to store, retrieve, and manage document-oriented or semi-structured data. When you use Elasticsearch, you store data in JSON document form. Then, you query them for retrieval.
- You have probably heard of the popular relational database called MySQL. Elastic search like MySQL is a database used to hold and query information.
- However, elastic search is typically used to perform full text searches on very large datasets.
- Documents are basically a json blob that hold your data as shown in the example below:
{"id":1, "name":"ghostlulz", "password":"SuperSecureP@ssword"}

### 4.1 Unauthenticated Elasticsearch DB
- Elastic search has an http server running on port 9200 that can be used to query the database. The major issue here is that a lot of people expose this port to the public internet without any kind of authentication.
- This means anyone can query the database and extract information. A quick Shodan search will produce a tun of results as shown below:
	![](assets/es.png)
- Once you have identified that your target has port 9200 open you can easily check if it is an Elasticsearch database by hitting the root directory with a GET request. The response should look something like:

	![](assets/es2.png)
	
<hr>

## 5. Docker API
- When you install docker on a system it will expose an API on your local host located on port 2375. This API can be used to interact with the docker engine which basically gives you the right to do anything you desire unauthenticated.
- Under these conditions no external party will be able to access your docker API as it isn't exposed to the world. However, in certain instances this API can be changed so that it can be accessed by external resources.